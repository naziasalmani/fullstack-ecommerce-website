<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Maharashtra Nature Park Nursery</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4a7c59;
            --secondary: #8fb996;
            --accent: #f9a826;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --text: #333;
            --danger: #dc3545;
            --success: #28a745;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--text);
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo img {
            height: 50px;
            margin-right: 10px;
        }
        
        .logo h1 {
            color: var(--primary);
            font-size: 1.8rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 25px;
        }
        
        nav ul li a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }
        
        nav ul li a:hover {
            color: var(--primary);
        }
        
        .cart-count {
            background-color: var(--accent);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            position: absolute;
            top: -8px;
            right: -8px;
        }
        
        /* Page Header */
        .page-header {
            background-color: #004225;
            color: white;
            padding: 80px 0 60px;
            text-align: center;
        }
        
        .page-header h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
        }
        
        .breadcrumb {
            display: flex;
            justify-content: center;
            list-style: none;
        }
        
        .breadcrumb li {
            margin: 0 10px;
        }
        
        .breadcrumb li a {
            color: var(--light);
            text-decoration: none;
        }
        
        .breadcrumb li::after {
            content: '/';
            margin-left: 20px;
            color: var(--light);
        }
        
        .breadcrumb li:last-child::after {
            content: '';
        }
        
        /* Checkout Content */
        .checkout-content {
            padding: 60px 0;
        }
        
        .checkout-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }
        
        /* Checkout Form */
        .checkout-form {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .checkout-form h2 {
            color: var(--primary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section h3 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .form-section h3 i {
            margin-right: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* Order Summary */
        .order-summary {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            align-self: start;
            position: sticky;
            top: 100px;
        }
        
        .order-summary h2 {
            color: var(--primary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .order-items {
            margin-bottom: 20px;
        }
        
        .order-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .order-item:last-child {
            border-bottom: none;
        }
        
        .order-item-name {
            font-weight: 500;
        }
        
        .order-item-price {
            color: var(--accent);
            font-weight: 600;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .summary-total {
            font-weight: 700;
            font-size: 1.2rem;
            margin: 20px 0;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        /* Payment Methods */
        .payment-methods {
            margin: 25px 0;
        }
        
        .payment-option {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .payment-option.selected {
            border-color: var(--primary);
            background-color: rgba(79, 124, 89, 0.05);
        }
        
        .payment-option input {
            margin-right: 15px;
        }
        
        .payment-icon {
            margin-right: 10px;
            font-size: 1.2rem;
            color: var(--primary);
        }
        
        /* Buttons */
        .btn {
            display: inline-block;
            background-color: var(--accent);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s;
            cursor: pointer;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .btn:hover {
            background-color: #e59400;
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }
        
        /* Success Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal-content {
            background-color: white;
            margin: 50px auto;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            animation: modalFade 0.3s;
            text-align: center;
            padding: 40px;
        }
        
        @keyframes modalFade {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-icon {
            font-size: 4rem;
            color: var(--success);
            margin-bottom: 20px;
        }
        
        .modal h2 {
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .modal p {
            margin-bottom: 25px;
            font-size: 1.1rem;
        }
        
        /* Footer */
        footer {
            background-color: #004225;
            color: white;
            padding: 60px 0 20px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-column h3 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        .footer-column p, .footer-column li {
            margin-bottom: 10px;
        }
        
        .footer-column ul {
            list-style: none;
        }
        
        .footer-column ul li a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-column ul li a:hover {
            color: var(--accent);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .social-links a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            transition: background-color 0.3s;
        }
        
        .social-links a:hover {
            background-color: var(--accent);
        }
        
        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: #ccc;
        }
        
        /* Responsive Styles */
        @media (max-width: 968px) {
            .checkout-container {
                grid-template-columns: 1fr;
            }
            
            .order-summary {
                position: static;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 20px;
                flex-direction: column;
                align-items: center;
            }
            
            nav ul li {
                margin: 10px 0;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .page-header h1 {
                font-size: 2.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-leaf" style="font-size: 2rem; color: var(--primary);"></i>
                    <h1>Nature Park Nursery</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="shop.html">Shop</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="contact.html">Contact</a></li>
                        <li>
                            <a href="cart.html">
                                <i class="fas fa-shopping-cart"></i>
                                <span class="cart-count" id="cart-count">0</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>Checkout</h1>
            <ul class="breadcrumb">
                <li><a href="index.html">Home</a></li>
                <li><a href="cart.html">Cart</a></li>
                <li>Checkout</li>
            </ul>
        </div>
    </section>

    <!-- Checkout Content -->
    <section class="checkout-content">
        <div class="container">
            <form id="checkout-form">
                <div class="checkout-container">
                    <div class="checkout-form">
                        <h2>Billing Information</h2>
                        
                        <div class="form-section">
                            <h3><i class="fas fa-user"></i> Personal Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="first-name">First Name</label>
                                    <input type="text" id="first-name" name="customerName" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="last-name">Last Name</label>
                                    <input type="text" id="last-name" class="form-control" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" name="customerEmail" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3><i class="fas fa-map-marker-alt"></i> Shipping Address</h3>
                            <div class="form-group">
                                <label for="address">Street Address</label>
                                <input type="text" id="address" name="customerAddress" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="city">City</label>
                                <input type="text" id="city" class="form-control" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="state">State</label>
                                    <input type="text" id="state" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="zip">ZIP Code</label>
                                    <input type="text" id="zip" class="form-control" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3><i class="fas fa-credit-card"></i> Payment Method</h3>
                            <div class="payment-methods">
                                <div class="payment-option" id="card-option">
                                    <input type="radio" name="payment-method" id="credit-card" value="credit-card" checked>
                                    <label for="credit-card">
                                        <i class="fas fa-credit-card payment-icon"></i>
                                        Credit/Debit Card
                                    </label>
                                </div>
                                <div class="payment-option" id="upi-option">
                                    <input type="radio" name="payment-method" id="upi" value="upi">
                                    <label for="upi">
                                        <i class="fas fa-mobile-alt payment-icon"></i>
                                        UPI Payment
                                    </label>
                                </div>
                                <div class="payment-option" id="cod-option">
                                    <input type="radio" name="payment-method" id="cod" value="cod">
                                    <label for="cod">
                                        <i class="fas fa-money-bill-wave payment-icon"></i>
                                        Cash on Delivery
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Credit Card Form -->
                            <div id="credit-card-form">
                                <div class="form-group">
                                    <label for="card-number">Card Number</label>
                                    <input type="text" id="card-number" class="form-control" placeholder="1234 5678 9012 3456">
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="expiry">Expiry Date</label>
                                        <input type="text" id="expiry" class="form-control" placeholder="MM/YY">
                                    </div>
                                    <div class="form-group">
                                        <label for="cvv">CVV</label>
                                        <input type="text" id="cvv" class="form-control" placeholder="123">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="card-name">Name on Card</label>
                                    <input type="text" id="card-name" class="form-control">
                                </div>
                            </div>
                            
                            <!-- UPI Form -->
                            <div id="upi-form" style="display: none;">
                                <div class="form-group">
                                    <label for="upi-id">UPI ID</label>
                                    <input type="text" id="upi-id" class="form-control" placeholder="yourname@upi">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="order-summary">
                        <h2>Order Summary</h2>
                        
                        <div class="order-items" id="order-items">
                            <!-- Order items will be dynamically inserted here -->
                        </div>
                        
                        <div class="summary-item">
                            <span>Subtotal</span>
                            <span id="order-subtotal">₹0</span>
                        </div>
                        
                        <div class="summary-item">
                            <span>Shipping</span>
                            <span id="order-shipping">₹0</span>
                        </div>
                        
                        <div class="summary-total">
                            <span>Total</span>
                            <span id="order-total">₹0</span>
                        </div>
                        
                        <button type="submit" class="btn btn-block" id="place-order-btn">Place Order</button>
                        <a href="cart.html" class="btn btn-block btn-outline" style="margin-top: 15px;">Back to Cart</a>
                        
                        <div style="margin-top: 20px; font-size: 0.9rem; color: #666;">
                            <p><i class="fas fa-info-circle"></i> Your personal data will be used to process your order and support your experience throughout this website.</p>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- Success Modal -->
    <div class="modal" id="success-modal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2>Order Placed Successfully!</h2>
            <p>Thank you for your purchase. Your order has been confirmed and will be processed shortly.</p>
            <p>Order ID: <strong id="order-id">MNPN-2023-001</strong></p>
            <p>You will receive a confirmation email shortly.</p>
            <a href="index.html" class="btn">Continue Shopping</a>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Nature Park Nursery</h3>
                    <p>Bringing nature closer to you. Quality plants at affordable prices.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-pinterest"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="shop.html">Shop</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Info</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> Maharashtra Nature Park, Mumbai</li>
                        <li><i class="fas fa-phone"></i> +91 98190 26308</li>
                        <li><i class="fas fa-envelope"></i> info@natureparknursery.com</li>
                        <li><i class="fas fa-clock"></i> Open: 8:30 AM - 3:30 PM</li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Nursery Information</h3>
                    <ul>
                        <li>Closed on 26 Jan, 1 May, 15 Aug & 2 Oct</li>
                        <li>Please bring your own carry bags</li>
                        <li>Vermicompost available: ₹30/kg</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 Maharashtra Nature Park Nursery. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

<script>
// checkout-script.js - Updated JavaScript for backend integration

document.addEventListener('DOMContentLoaded', function() {
    let cart = JSON.parse(localStorage.getItem('plantNurseryCart')) || []; // Use consistent key
    updateOrderSummary();
    updateCartCount();

    const paymentOptions = document.querySelectorAll('.payment-option');
    const creditCardForm = document.getElementById('credit-card-form');
    const upiForm = document.getElementById('upi-form');

    // Payment method selection
    paymentOptions.forEach(option => {
        option.addEventListener('click', function() {
            paymentOptions.forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;

            if (radio.value === 'credit-card') {
                creditCardForm.style.display = 'block';
                upiForm.style.display = 'none';
            } else if (radio.value === 'upi') {
                creditCardForm.style.display = 'none';
                upiForm.style.display = 'block';
            } else {
                creditCardForm.style.display = 'none';
                upiForm.style.display = 'none';
            }
        });
    });

    // Form submission handler
    document.getElementById('checkout-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (!validateForm()) return;
        
        const cart = JSON.parse(localStorage.getItem('plantNurseryCart')) || []; // Use consistent key
        if (cart.length === 0) {
            alert('Your cart is empty');
            return;
        }
        
        // Disable submit button to prevent double submission
        const submitBtn = document.getElementById('place-order-btn');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        
        // Collect form data
        const customerName = document.getElementById('first-name').value + ' ' + document.getElementById('last-name').value;
        const customerEmail = document.getElementById('email').value;
        const customerAddress = `${document.getElementById('address').value}, ${document.getElementById('city').value}, ${document.getElementById('state').value} - ${document.getElementById('zip').value}`;
        const totalAmount = parseFloat(document.getElementById('order-total').textContent.replace('₹', ''));

        const orderData = {
            customerName: customerName,
            customerEmail: customerEmail,
            customerAddress: customerAddress,
            items: cart.map(item => ({
                id: item.id,
                name: item.name,
                price: item.price,
                quantity: item.quantity
            })),
            total: totalAmount,
            paymentMethod: document.querySelector('input[name="payment-method"]:checked').value,
            // You can add more details like card info or UPI ID if needed by the backend
        };
        
        try {
            // CORRECTED LINE: Changed to '/api/orders'
            const response = await fetch('http://localhost:5000/api/orders', {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(orderData)
            });

            const contentType = response.headers.get('content-type');
            if (!contentType || !contentType.includes('application/json')) {
                const text = await response.text();
                throw new Error(`Server returned HTML instead of JSON. Please check the API endpoint. Response: ${text.substring(0, 100)}`);
            }
            
            const result = await response.json();
            
            if (!response.ok) {
                throw new Error(result.message || `Server error: ${response.status}`);
            }
            
            if (result.success) {
                // Clear cart
                localStorage.removeItem('plantNurseryCart'); // Use consistent key
                
                // Show success modal
                document.getElementById('order-id').textContent = result.data.id; // Use result.data.id for the order ID
                document.getElementById('success-modal').style.display = 'block';
                
                // Update cart count
                updateCartCount();
                
                console.log('Order placed successfully:', result.data.id);
            } else {
                throw new Error(result.message || 'Failed to place order');
            }
        } catch (error) {
            console.error('Order error:', error);
            alert('Error placing order: ' + error.message + '. Please try again.');
        } finally {
            // Re-enable submit button
            submitBtn.disabled = false;
            submitBtn.innerHTML = 'Place Order';
        }
    });

    // Modal close functionality
    document.addEventListener('click', function(e) {
        if (e.target.id === 'success-modal') {
            document.getElementById('success-modal').style.display = 'none';
            // Redirect to home page after closing modal
            window.location.href = 'index.html';
        }
    });

    function updateOrderSummary() {
        const orderItemsContainer = document.getElementById('order-items');
        const subtotalElement = document.getElementById('order-subtotal');
        const shippingElement = document.getElementById('order-shipping');
        const totalElement = document.getElementById('order-total');

        orderItemsContainer.innerHTML = '';

        if (cart.length === 0) {
            // If cart is empty, redirect back to cart page
            window.location.href = 'cart.html';
            return;
        }

        let subtotal = 0;
        cart.forEach(item => {
            const itemTotal = parseInt(item.price) * item.quantity;
            subtotal += itemTotal;

            const orderItem = document.createElement('div');
            orderItem.className = 'order-item';
            orderItem.innerHTML = `
                <div class="order-item-name">${item.name} × ${item.quantity}</div>
                <div class="order-item-price">₹${itemTotal}</div>
            `;
            orderItemsContainer.appendChild(orderItem);
        });

        const shipping = subtotal >= 500 ? 0 : 50;
        const total = subtotal + shipping;

        subtotalElement.textContent = `₹${subtotal}`;
        shippingElement.textContent = `₹${shipping}`;
        totalElement.textContent = `₹${total}`;
    }

    function updateCartCount() {
        const cart = JSON.parse(localStorage.getItem('plantNurseryCart')) || []; // Use consistent key
        const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
        const cartCountElement = document.getElementById('cart-count');
        if (cartCountElement) {
            cartCountElement.textContent = totalItems;
        }
    }

    function validateForm() {
        const requiredFields = document.querySelectorAll('#checkout-form [required]');
        let isValid = true;

        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                isValid = false;
                field.style.borderColor = 'var(--danger)';
                field.addEventListener('input', function() {
                    this.style.borderColor = '#ddd';
                });
            } else {
                field.style.borderColor = '#ddd';
            }
        });

        if (!isValid) {
            alert('Please fill in all required fields');
            return false;
        }

        // Validate email format
        const email = document.getElementById('email').value;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            alert('Please enter a valid email address');
            document.getElementById('email').style.borderColor = 'var(--danger)';
            return false;
        }

        // Validate payment method specific fields
        const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;

        if (paymentMethod === 'credit-card') {
            const cardNumber = document.getElementById('card-number').value;
            const expiry = document.getElementById('expiry').value;
            const cvv = document.getElementById('cvv').value;
            const cardName = document.getElementById('card-name').value;

            if (!cardNumber || !expiry || !cvv || !cardName) {
                alert('Please fill in all credit card details');
                return false;
            }

            // Basic card number validation (remove spaces and check length)
            const cleanCardNumber = cardNumber.replace(/\s/g, '');
            if (cleanCardNumber.length < 13 || cleanCardNumber.length > 19) {
                alert('Please enter a valid card number');
                return false;
            }

            // Basic expiry validation (MM/YY format)
            if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiry)) {
                alert('Please enter expiry date in MM/YY format');
                return false;
            }

            // CVV validation
            if (!/^\d{3,4}$/.test(cvv)) {
                alert('Please enter a valid CVV (3-4 digits)');
                return false;
            }

        } else if (paymentMethod === 'upi') {
            const upiId = document.getElementById('upi-id').value;
            if (!upiId) {
                alert('Please enter your UPI ID');
                return false;
            }

            // Basic UPI ID validation
            if (!/^[a-zA-Z0-9.\-_]+@[a-zA-Z0-9.-]+$/.test(upiId)) {
                alert('Please enter a valid UPI ID (e.g., name@upi)');
                return false;
            }
        }

        return true;
    }

    // Format card number input (add spaces every 4 digits)
    document.getElementById('card-number').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\s/g, '');
        let formattedValue = value.replace(/(.{4})/g, '$1 ').trim();
        if (formattedValue.length <= 23) { // Max 19 digits + 4 spaces
            e.target.value = formattedValue;
        }
    });

    // Format expiry date input (MM/YY)
    document.getElementById('expiry').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length >= 2) {
            value = value.substring(0, 2) + '/' + value.substring(2, 4);
        }
        e.target.value = value;
    });

    // CVV input (numbers only)
    document.getElementById('cvv').addEventListener('input', function(e) {
        e.target.value = e.target.value.replace(/\D/g, '').substring(0, 4);
    });

    // Phone number validation
    document.getElementById('phone').addEventListener('input', function(e) {
        e.target.value = e.target.value.replace(/\D/g, '').substring(0, 10);
    });
});
</script>

</body>
</html>